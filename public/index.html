<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Novella App - Main</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preload" href="/fonts/Uni Sans.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/MaiandraGD.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/Unispace.ttf" as="font" type="font/ttf" crossorigin="anonymous">
</head>
<body>
    <div class="main-page">
        <header>
            <button class="freedurov-button" onclick="window.open('https://www.change.org/p/free-pavel-durov-freedurov?source_location=tag_')">
                #FREEDUROV
            </button>
        </header>
        <div class="token-section">
            <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1725622251/Novellacoin.png" alt="Token Icon" class="token-icon" id="token-icon">
            <p id="token-balance" class="token-balance">0</p>
        </div>

        <!-- Telegram ID -->
        <div id="telegram-id-container">
            <p id="telegram-id" class="user-id-number">You userId: </p>
        </div>

        <!-- Daily Reward - Ежедневный вход и бонусы -->
        <div class="daily-reward-container">
            <p class="daily-reward-title">DAILY REWARDS</p>
            <div class="daily-reward-wrapper">
                <button id="claim-reward-button" class="daily-reward-button" onclick="claimReward()">Daily Check in +100 $Novella</button>
                <button id="premium-reward-button" class="premium-reward-button" onclick="claimPremiumReward()">Premium Check in +1000 $Novella</button>
                <div class="timer-container">
                    <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1726574752/Element/Timer.png" alt="Timer" class="timer-icon">
                    <span id="timer" class="timer">24:00:00</span>
                </div>
            </div>
        </div>

        <!-- Bottom Menu -->
        <nav class="bottom-menu">
            <a href="index.html" class="menu-item active">
                <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1726420961/Menu/Button%20version%202/Main_iconmenu.png" alt="Main">
                <span>Main</span>
            </a>
            <a href="task.html" class="menu-item">
                <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1726420961/Menu/Button%20version%202/Task_iconmenu.png" alt="Task">
                <span>Task</span>
            </a>
            <a href="friends.html" class="menu-item">
                <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1726937838/Menu/Button%20version%202/Friends.png" alt="Friends">
                <span>Friends</span>
            </a>
            <a href="airdrop.html" class="menu-item">
                <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1726420961/Menu/Button%20version%202/Airdrop_iconmenu.png" alt="Airdrop">
                <span>Airdrop</span>
            </a>
            <a href="leaders.html" class="menu-item">
                <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1726420961/Menu/Button%20version%202/Leaders_iconmenu.png" alt="Leaders">
                <span>Leaders</span>
            </a>
        </nav>
    </div>
    <script src="/dailyreward.js"></script>

    <script>
        // Получаем telegramId из URL
        const urlParams = new URLSearchParams(window.location.search);
        const telegramId = urlParams.get('userId');
    
        // Проверяем, есть ли telegramId, и если да, отображаем его
        if (telegramId) {
            document.getElementById('telegram-id').innerText += telegramId;
        } else {
            document.getElementById('telegram-id').innerText += "User id Not found.";
        }
    </script> 
    
        <!-- Скрипт для воспроизведения звука при нажатии на иконку токена -->
        <script>
            const tokenIcon = document.getElementById('token-icon');
    
            tokenIcon.addEventListener('click', () => {
                const audio = new Audio('/sound/nose-sound.mp3');
                audio.play();
            });
        </script>
    
        <!-- Скрипт для получения баланса -->
        <script>
            // Функция для извлечения параметров из URL
            function getTelegramIdFromURL() {
                const params = new URLSearchParams(window.location.search);
                return params.get('userId');
            }
            if (telegramId) {
                fetch(`/get-balance/${telegramId}`)
                    .then(response => response.json())
                    .then(data => {
                        updateBalance(data.tokens); // Обновляем отображение баланса на странице
                    })
                    .catch(error => console.error('Ошибка получения баланса:', error));
            } else {
                console.error('Telegram ID не найден в URL');
            }
            
            // Функция для обновления баланса
            function updateBalance(newBalance) {
                const balanceElement = document.getElementById('token-balance');
                balanceElement.textContent = newBalance;
            }
        </script>
</body>
</html>