<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novella App - Loading</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preload" href="/fonts/Polaris.otf" as="font" type="font/otf" crossorigin="anonymous">
</head>
<body>
    <div class="loading-container">
        <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1725622251/Novellacoin.png" alt="Loading Icon" class="loading-icon">
    </div>
    
    <!-- Название NOVELLA -->
    <div class="novella-title">
        <span>N</span><span>O</span><span>V</span><span>E</span><span>L</span><span>L</span><span>A</span>
    </div>
    
    <!-- Блок для иконок социальных сетей -->
    <div class="social-icons">
        <a href="https://www.instagram.com/novellatoken_community" target="_blank">
            <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1727110754/Social/Instagram-load_icon.png" alt="Instagram Icon" class="social-icon">
        </a>
        <a href="https://www.youtube.com/@NovellaApp" target="_blank">
            <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1727110754/Social/Youtube-load_icon.png" alt="YouTube Icon" class="social-icon">
        </a>
        <a href="https://t.me/novellatoken_community" target="_blank">
            <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1727110754/Social/Telegram-load_icon.png" alt="Telegram Icon" class="social-icon">
        </a>
        <a href="https://x.com/novellatoken_community" target="_blank">
            <img src="https://res.cloudinary.com/dvjohgg6j/image/upload/v1727110754/Social/X-load_icon.png" alt="X Icon" class="social-icon">
        </a>
    </div>
  
    <!-- Версия приложения -->
    <div class="app-version">
        Version: 1.0.0
    </div>
    
    <script>
        // Получаем telegramId из URL
        const urlParams = new URLSearchParams(window.location.search);
        const telegramId = urlParams.get('userId');

        if (telegramId) {
            fetch(`/check-user/${telegramId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.redirect) {
                        // Если требуется перенаправление на другую страницу
                        setTimeout(() => {
                            window.location.href = data.redirect;
                        }, 5000); // Задержка в 5 секунд
                    } else {
                        // Перенаправляем на index.html с userId
                        setTimeout(() => {
                            window.location.href = `/index.html?userId=${telegramId}`;
                        }, 5000); // Задержка в 5 секунд
                    }
                })
                .catch(error => {
                    console.error('Произошла ошибка:', error);
                    setTimeout(() => {
                        window.location.href = '/loadingerror';
                    }, 5000); // Задержка в 5 секунд
                });
        } else {
            console.error('username ID отсутствует в URL, перенаправляем на loadingerror');
            setTimeout(() => {
                window.location.href = '/loadingerror';
            }, 5000); // Задержка в 5 секунд
        }
    </script>    

</body>
</html>
